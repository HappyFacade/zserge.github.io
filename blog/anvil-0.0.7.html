<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, minimumscale=1.0, maximum-scale=1.0" />
		<title> Anvil: Double O Seven </title>
		<meta name="description" content="A preferred way to prepare your android apps. Shaken, not stirred." />
		<meta name="keywords" content="android UI, android design, android architecture, android mvc, simple android animations, android react.js, android reactive UI, butterknife, dagger" />
		<link href='http://fonts.googleapis.com/css?family=Crimson+Text:400,400italic,600,600italic,700,700italic' rel='stylesheet' type='text/css'>
		<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="/styles.css" />
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
			ga('create', 'UA-33644825-1', 'zserge.com');
			ga('send', 'pageview');
		</script>
	</head>
	<body>
		<nav class='menu'>/*
			<ul class='menu'>
				<li><a class='menu-link' href="/">home</a></li>
				<li><a class='menu-link' href="/projects.html">code</a></li>
				<li><a class='menu-link' href="/blog.html">blog</a></li>
			</ul>*/
		</nav>
		<h1>Anvil: version 0.0.7 released!</h1>

<p>If you missed the news - <a href="https://github.com/zserge/anvil">Anvil</a> is a tiny
reactive UI library for Android. It's based on the concept of the virtual
layout (much like React.js) and brings declarative layouts with data bindings,
componentization, styles, animations etc in pure Java.</p>

<p>It also supports Kotlin, which is a great language and I hope it will replace
Java on Android some day.</p>

<p>Version 0.0.6 was suprisingly stable, but life goes on, and here's version 0.0.7.</p>

<h2>config() helper</h2>

<p>If you really have to work with real views and not the virtual layout - you can
do it now. It's helpful for SurfaceViews, TextureViews and other views where
just setting the attributes is not enough.</p>

<p>Also it can be helpful if you want to migrate to Anvil gradually - you can move
layouts to Java, but let the configuration of the views (binding callbacks,
setting styles and attrobutes) happen in existing methods:</p>

<pre><code>public void initUi() {
    mMyButton = (Button) findViewById(MY_BUTTON);
    mMyButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
        }
    });
}

public ViewNode view() {
    return
        v(LinearLayout.class,
            config(v -&gt; initUi), // initUi will be called when layout is ready
            v(Button.class,
                id(MY_BUTTON)));
}
</code></pre>

<p>Of course, it's highly recommented to use config() wisely and let Anvil deal
with your data binding.</p>

<h2>better syntax for views</h2>

<p>Some people requested to add more sugar to view trees, so now there is a
generated file Views.java which simplifies the tree construction of the
existing view classes from the Android SDK JAR:</p>

<pre><code>// Normal Anvil variant
v(LinearLayout.class,
    v(Button.class,
        text(R.string.click_me)
        onClick(onButtonClick)),
    v(TextView.class,
        text(someText))

// &quot;Sugarized&quot; variant, aligning parens is a matter of taste, of course
linearLayout(
    button(
        text(R.string.click_me),
        onClick(onButtonClick)
    ),
    textView(
        text(someText)
    )
)
</code></pre>

<p>Another advantage is that you don't need to import every view class that you're
using in your layouts.</p>

<p>Of course, the traditional v() approach remains, and is the only way you can
add your custom classes into the view tree.</p>

<h2>relative layout</h2>

<p>With 0.0.7 you can now use it like:</p>

<pre><code>v(RelativeLayout.class,
    size(FILL, FILL),
    padding(dip(16), 0),

    v(EditText.class,
        id(ID_NAME),
        hint(&quot;Reminder time&quot;),
        size(FILL, WRAP)),

    v(Spinner.class,
        id(ID_DATES),
        size(0, WRAP)
            .align(BELOW, ID_NAME)
            .align(ALIGN_PARENT_LEFT)
            .align(LEFT_OF, ID_TIMES)),

    v(Spinner.class,
        id(ID_TIMES),
        size(dip(96), WRAP)
            .align(BELOW, ID_NAME)
            .align(ALIGN_PARENT_RIGHT)),

    v(Button.class,
        text(&quot;Done&quot;),
        size(dip(96), WRAP)
            .align(BELOW, ID_TIMES)
            .align(ALIGN_PARENT_RIGHT)));
</code></pre>

<h2>other things</h2>

<p>There's been many bug fixes and small changes since 0.0.6.</p>

<p>Probably the most notable minor improvement is that you can now call
Anvil.render() from any thread, not just the UI thread. It simplifies code a
lot in background tasks where you don't care about the Context, but modify the
data that is reflected in the UI somehow.</p>

<h2>Matter of state importance</h2>

<p>One last thing to list here is states. Anvil's strong point is declarative
animations. You can declare them right in your layout - how they behave, when
they are started/stopped etc. Then you can trigger them by just changing one
boolean variable.</p>

<p>However when your animations start to chain and depend on each other - it can
become pretty messy (but still cleaner than if you used only andorid SDK).</p>

<p>Now there are States - tiny two-state finite state machines that can slowly (or immidiately)
switch from one state (&quot;on&quot;) to another (&quot;off&quot;) and back. Binding animations to
the states instead of raw boolean variables gives your more flexibility over
time and sequence of data changes that involve view animations.</p>

<p>However I have to acknowledge you that States API is still experimental and
might be changed in future versions.</p>

<p>Posted on 2015-06-25 <span class='rss' style='float: right;'>[<a href="/rss.xml">rss</a>]</span></p>

<p><script type="text/javascript">(function() {
  if (window.pluso)if (typeof window.pluso.start == 'function') return;
  if (window.ifpluso==undefined) { window.ifpluso = 1;
    var d = document, s = d.createElement('script'), g = 'getElementsByTagName';
    s.type = 'text/javascript'; s.charset='UTF-8'; s.async = true;
    s.src = ('https:' == window.location.protocol ? 'https' : 'http')  + '://share.pluso.ru/pluso-like.js';
    var h=d[g]('body')[0];
    h.appendChild(s);
  } })();</script>
<div class="pluso" data-lang="en" data-background="transparent" data-options="medium,round,line,horizontal,nocounter,theme=02" data-services="facebook,twitter,google,vkontakte,email" data-url="http://zserge.com" data-title="zserge's blog" data-description="My thoughts on software and simplicity"></div></p>

<p><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname='zserge';
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>
</noscript></p>

		<footer></footer>
	</body>
</html>

